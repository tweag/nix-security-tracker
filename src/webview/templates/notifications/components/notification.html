{% load viewutils %}
{% if new_unread_count is not None %}
{% notifications_badge count=new_unread_count oob_update=True %}
{% endif %}
<article class="rounded-box column gap {% if not notification.is_read %}highlight{% endif %}" id="notification-{{ notification.id }}">
  <header class="row gap spread">
    <h3 class="heading">{{ notification.title }}</h3>
    <time datetime="{{ notification.created_at|date }}" class="notification-date">{{ notification.created_at|date:"M d, Y H:i" }}</time>
  </header>
  <div class="notification-content">
    {{ notification.message|linebreaks }}
  </div>
  <form method="post" action="{% url 'webview:notifications:toggle_read' notification.id %}" class="row-reverse" hx-indicator="find button">
    {% csrf_token %}
    {% if current_page %}
      <!-- Preserve current page if we're in a paginated view in no-js mode -->
      <input type="hidden" name="page" value="{{ current_page }}">
    {% endif %}
    <button 
      type="submit"
      hx-post="{% url 'webview:notifications:toggle_read' notification.id %}"
      hx-swap="outerHTML"
      hx-target="#notification-{{ notification.id }}"
      class="btn {%if not notification.is_read %}btn-green{% else %}btn-gray{% endif %}">
      Mark {%if not notification.is_read %}read{% else %}unread{% endif %}
    </button>
  </form>
</article>
